{{ define "main" }}
<header>
    <div class="intro-section">
        <h1>{{ .Site.Title }}</h1>
        <p>{{ .Site.Params.description }}</p>
    </div>
</header>

<main>
    {{ $featured := where .Site.RegularPages "Params.featured" true }}
    {{ if $featured }}
    <section id="featured" class="content-section">
        <h1>featured</h1>
        <div class="featured-posts">
            {{ range first 3 $featured }}
            <article class="featured-post">
                <h3><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
                <div class="post-meta">
                    <span class="post-date">{{ .Date.Format "2006-01-02" }}</span>
                </div>
                <div class="post-excerpt">
                    {{ with .Description }}{{ . }}{{ else }}{{ .Summary }}{{ end }}
                </div>
                <a href="{{ .RelPermalink }}" class="read-more">read more →</a>
            </article>
            {{ end }}
        </div>
    </section>
    {{ end }}

    <section id="recent-posts" class="content-section">
        <h1>recent posts</h1>
        <div class="post-list">
            {{ $paginator := .Paginate (where .Site.RegularPages "Type" "posts") }}
            {{ range $paginator.Pages }}
            <article class="post-item">
                <h3><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
                <div class="post-meta">
                    <span class="post-date">{{ .Date.Format "2006-01-02" }}</span>
                </div>
                <div class="post-excerpt">
                    {{ with .Description }}{{ . }}{{ else }}{{ .Summary }}{{ end }}
                </div>
                <a href="{{ .RelPermalink }}" class="read-more">read more →</a>
            </article>
            {{ end }}
            <div class="view-all">
                <a href="/blog" class="view-all-link">view all posts →</a>
            </div>
        </div>
    </section>
</main>
{{ end }}
